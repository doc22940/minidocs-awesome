<!doctype html>
<html lang="en" dir="ltr">
<head>
<title>Awesome Dat</title>
<meta charset="utf-8">

<link rel="stylesheet" href="/bundle.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/style.css">
</head>
<body>
<div id="choo-root" class="_d4e87350 minidocs flex flex-column m0 h-100">
      <div class="minidocs-header-flex flex">
        <header class="_19f2d18a minidocs-header ph4 w-100 bg-black-90">
    <nav class="flex justify-between">
      <div class="flex items-center">
        <div class="menu-button">
          <a class=" menu-toggle"></a>
        </div>
        <a href="/" title="Awesome Dat" class="inline-flex items-center">
        <img src="/dat-data-logo.svg" alt="Awesome Dat" class="minidocs-header-logo dib w2 h2" />
        <span class="minidocs-header-title ml2 pr2 white">Awesome Dat</span>
      </a>
      </div>
      <div class="minidocs-header-nav flex-grow flex items-center tr ttu">
        <a href="/install" title="Install" class="minidocs-header-link white dim link dn dib-ns mr3-ns">Install</a>
        <a href="http://datproject.org/" title="Home" class="minidocs-header-link white dim link dib mr3-ns">Home</a>
      </div>
    </nav>
  </header>
      </div>
      <main class="minidocs-main-flex flex">
        <div class="minidocs-sidebar-flex open order-0 overflow-auto bg-near-white">
        <div class="_068b628f minidocs-menu pa3">
      <div class="f3 pt2">Welcome</div><div><a href="/awesome-dat" class="content-link ">Awesome Dat</a></div><div class="f3 pt2">Dat Applications</div><div><a href="/dat" class="content-link ">datproject/dat</a></div><div><a href="/dat-desktop" class="content-link ">datproject/dat-desktop</a></div><div class="f3 pt2">Community Applications</div><div><a href="/sciencefair" class="content-link ">codeforscience/sciencefair</a></div><div><a href="/hyperirc" class="content-link ">mafintosh/hyperirc</a></div><div><a href="/soundcloud-archiver" class="content-link ">jondashkyle/soundcloud-archiver</a></div><div><a href="/hypervision" class="content-link ">mafintosh/hypervision</a></div><div><a href="/hypertweet" class="content-link ">joehand/hypertweet</a></div><div><a href="/dat-photos-app" class="content-link ">beakerbrowser/dat-photos-app</a></div><div class="f3 pt2">High-Level APIs</div><div>
            <a href="/dat-node" class="content-link active">datproject/dat-node</a>
            <div class="minidocs-menu-toc">
              <a href="#example" class="f5 content-link">Example</a><a href="#usage" class="f5 content-link">Usage</a><a href="#api" class="f5 content-link">API</a><a href="#license" class="f5 content-link">License</a>
            </div>
          </div><div><a href="/dat-js" class="content-link ">datproject/dat-js</a></div><div><a href="/pauls-dat-api" class="content-link ">beakerbrowser/pauls-dat-api</a></div><div><a href="/node-dat-archive" class="content-link ">beakerbrowser/node-dat-archive</a></div><div class="f3 pt2">Hosting &amp; Dat Management</div><div><a href="/hypercore-archiver" class="content-link ">mafintosh/hypercore-archiver</a></div><div><a href="/hypercloud" class="content-link ">datprotocol/hypercloud</a></div><div><a href="/hashbase" class="content-link ">beakerbrowser/hashbase</a></div><div><a href="/dat-now" class="content-link ">joehand/dat-now</a></div><div><a href="/hypercore-archiver-bot" class="content-link ">mafintosh/hypercore-archiver-bot</a></div><div><a href="/hypercore-archiver-ws" class="content-link ">joehand/hypercore-archiver-ws</a></div><div><a href="/dat-registry-api" class="content-link ">datproject/dat-registry-api</a></div><div><a href="/dat-registry-client" class="content-link ">datproject/dat-registry-client</a></div><div class="f3 pt2">Managing &amp; Aggregating Dats</div><div><a href="/multidat" class="content-link ">datproject/multidat</a></div><div><a href="/multidrive" class="content-link ">datproject/multidrive</a></div><div><a href="/dat-pki" class="content-link ">jayrbolton/dat-pki</a></div><div><a href="/injestdb" class="content-link ">beakerbrowser/injestdb</a></div><div class="f3 pt2">Http Hosting</div><div><a href="/hyperdrive-http" class="content-link ">joehand/hyperdrive-http</a></div><div><a href="/dathttpd" class="content-link ">beakerbrowser/dathttpd</a></div><div class="f3 pt2">Dat Link Utilties</div><div><a href="/dat-dns" class="content-link ">datprotocol/dat-dns</a></div><div><a href="/dat-link-resolve" class="content-link ">joehand/dat-link-resolve</a></div><div><a href="/parse-dat-url" class="content-link ">pfrazee/parse-dat-url</a></div><div><a href="/dat-encoding" class="content-link ">juliangruber/dat-encoding</a></div><div class="f3 pt2">Dat Utilities</div><div><a href="/dat-log" class="content-link ">joehand/dat-log</a></div><div><a href="/dat-ls" class="content-link ">mafintosh/dat-ls</a></div><div><a href="/hyperhealth" class="content-link ">karissa/hyperhealth</a></div><div><a href="/hyperdrive-network-speed" class="content-link ">joehand/hyperdrive-network-speed</a></div><div class="f3 pt2">File Imports &amp; Exports</div><div><a href="/hyperdrive-import-files" class="content-link ">juliangruber/hyperdrive-import-files</a></div><div><a href="/mirror-folder" class="content-link ">mafintosh/mirror-folder</a></div><div><a href="/hyperdrive-staging-area" class="content-link ">pfrazee/hyperdrive-staging-area</a></div><div><a href="/hyperdrive-to-zip-stream" class="content-link ">pfrazee/hyperdrive-to-zip-stream</a></div><div class="f3 pt2">Hypercore Tools</div><div><a href="/hyperpipe" class="content-link ">mafintosh/hyperpipe</a></div><div class="f3 pt2">Dat Core Modules</div><div><a href="/hyperdrive" class="content-link ">mafintosh/hyperdrive</a></div><div><a href="/hypercore" class="content-link ">mafintosh/hypercore</a></div><div class="f3 pt2">CLI Utilities</div><div><a href="/dat-doctor" class="content-link ">joehand/dat-doctor</a></div><div><a href="/dat-ignore" class="content-link ">joehand/dat-ignore</a></div><div><a href="/dat-json" class="content-link ">joehand/dat-json</a></div><div class="f3 pt2">Networking</div><div><a href="/hyperdiscovery" class="content-link ">karissa/hyperdiscovery</a></div><div><a href="/discovery-swarm" class="content-link ">mafintosh/discovery-swarm</a></div><div><a href="/webrtc-swarm" class="content-link ">mafintosh/webrtc-swarm</a></div><div><a href="/dat-swarm-defaults" class="content-link ">joehand/dat-swarm-defaults</a></div><div class="f3 pt2">Lower level networking modules</div><div><a href="/discovery-channel" class="content-link ">maxogden/discovery-channel</a></div><div><a href="/dns-discovery" class="content-link ">mafintosh/dns-discovery</a></div><div><a href="/multicast-dns" class="content-link ">mafintosh/multicast-dns</a></div><div><a href="/bittorrent-dht" class="content-link ">webtorrent/bittorrent-dht</a></div><div><a href="/utp-native" class="content-link ">mafintosh/utp-native</a></div><div><a href="/signalhub" class="content-link ">mafintosh/signalhub</a></div><div class="f3 pt2">Storage</div><div><a href="/dat-storage" class="content-link ">datproject/dat-storage</a></div><div><a href="/dat-secret-storage" class="content-link ">datproject/dat-secret-storage</a></div><div class="f3 pt2">Random Access</div><div><a href="/abstract-random-access" class="content-link ">juliangruber/abstract-random-access</a></div><div><a href="/multi-random-access" class="content-link ">mafintosh/multi-random-access</a></div><div><a href="/random-access-file" class="content-link ">mafintosh/random-access-file</a></div><div><a href="/random-access-memory" class="content-link ">mafintosh/random-access-memory</a></div><div><a href="/random-access-page-files" class="content-link ">mafintosh/random-access-page-files</a></div><div><a href="/dat-http" class="content-link ">datproject/dat-http</a></div><div><a href="/random-access-idb" class="content-link ">substack/random-access-idb</a></div><div class="f3 pt2">Other Related Dat Project Modules</div><div><a href="/peer-network" class="content-link ">mafintosh/peer-network</a></div><div><a href="/hyperdht" class="content-link ">mafintosh/hyperdht</a></div><div class="f3 pt2">Dat Project Organization Stuff</div><div><a href="/datproject.org" class="content-link ">datproject/datproject.org</a></div><div><a href="/discussions" class="content-link ">datproject/discussions</a></div><div><a href="/design" class="content-link ">datproject/design</a></div><div><a href="/dat-elements" class="content-link ">datproject/dat-elements</a></div><div><a href="/dat-colors" class="content-link ">kriesse/dat-colors</a></div><div><a href="/dat-icons" class="content-link ">kriesse/dat-icons</a></div><div><a href="/dat.json" class="content-link ">juliangruber/dat.json</a></div><div class="f3 pt2">Outdated</div><div><a href="/dat.haus" class="content-link ">juliangruber/dat.haus</a></div><div><a href="/hyperfeed" class="content-link ">poga/hyperfeed</a></div><div><a href="/normcore" class="content-link ">yoshuawuyts/normcore</a></div><div><a href="/github-to-hypercore" class="content-link ">yoshuawuyts/github-to-hypercore</a></div><div><a href="/hyperspark" class="content-link ">poga/hyperspark</a></div><div><a href="/hypercore-index" class="content-link ">juliangruber/hypercore-index</a></div><div><a href="/hyperdrive-encoding" class="content-link ">juliangruber/hyperdrive-encoding</a></div><div><a href="/hyperdrive-http-server" class="content-link ">mafintosh/hyperdrive-http-server</a></div><div><a href="/hyperdrive-http" class="content-link ">joehand/hyperdrive-http</a></div><div><a href="/dat-push" class="content-link ">joehand/dat-push</a></div><div><a href="/dat-backup" class="content-link ">joehand/dat-backup</a></div><div><a href="/archiver-server" class="content-link ">joehand/archiver-server</a></div><div><a href="/archiver-api" class="content-link ">joehand/archiver-api</a></div><div><a href="/hyperdrive-ln" class="content-link ">poga/hyperdrive-ln</a></div><div><a href="/hyperdrive-multiwriter" class="content-link ">substack/hyperdrive-multiwriter</a></div><div><a href="/hyperdrive-named-archives" class="content-link ">substack/hyperdrive-named-archives</a></div><div><a href="/git-dat" class="content-link ">substack/git-dat</a></div><div><a href="/jawn" class="content-link ">CfABrigadePhiladelphia/jawn</a></div><div><a href="/dat-archiver" class="content-link ">maxogden/dat-archiver</a></div><div><a href="/hyperdrive-stats" class="content-link ">juliangruber/hyperdrive-stats</a></div><div><a href="/hypercore-stats-server" class="content-link ">karissa/hypercore-stats-server</a></div><div><a href="/hypercore-stats-ui" class="content-link ">mafintosh/hypercore-stats-ui</a></div><div><a href="/zip-to-hyperdrive" class="content-link ">karissa/zip-to-hyperdrive</a></div><div><a href="/url-dat" class="content-link ">joehand/url-dat</a></div><div><a href="/tar-dat" class="content-link ">joehand/tar-dat</a></div><div><a href="/hyperdrive-duplicate" class="content-link ">joehand/hyperdrive-duplicate</a></div>
    </div>
      </div>
        <div id="minidocs-content" class="minidocs-content-flex order-1 overflow-auto">
          <div class="_32076d68 pa3 ph5-ns pv4-ns">
    
    
    <div><h1 id="dat-node"><a href="#dat-node" class="anchor"></a>dat-node</h1><blockquote>
<p><strong>dat-node</strong> is a high-level module for building Dat applications on the file system.</p>
</blockquote>
<p><a href="https://npmjs.org/package/dat-node"><img src="https://img.shields.io/npm/v/dat-node.svg?style=flat-square" alt="npm"></a> <a href="https://travis-ci.org/datproject/dat-node"><img src="https://img.shields.io/travis/datproject/dat-node/master.svg?style=flat-square" alt="Travis"></a> <a href="https://codecov.io/github/datproject/dat-node"><img src="https://img.shields.io/codecov/c/github/datproject/dat-node/master.svg?style=flat-square" alt="Test coverage"></a></p>
<p><a href="http://datproject.org">Dat</a> is a decentralized tool for distributing data and
files, built for scientific and research data.
You can start using Dat today in these client applications:</p>
<ul>
<li><a href="https://github.com/datproject/dat">Dat Command Line</a>: Use Dat in the command line</li>
<li><a href="https://github.com/datproject/dat-desktop">Dat Desktop</a>: A desktop application for Dat</li>
<li><a href="https://beakerbrowser.com">Beaker Browser</a>: An experimental P2P browser with Dat built in</li>
</ul>
<h4 id="dat-project-documentation-and-resources"><a href="#dat-project-documentation-and-resources" class="anchor"></a>Dat Project Documentation &amp; Resources</h4><ul>
<li><a href="http://docs.datproject.org/">Dat Project Docs</a></li>
<li><a href="https://www.datprotocol.com/">Dat Protocol</a></li>
<li><a href="https://gitter.im/datproject/discussions">Gitter Chat</a> or <a href="http://webchat.freenode.net/?channels=dat">#dat on IRC</a></li>
</ul>
<h3 id="features"><a href="#features" class="anchor"></a>Features</h3><ul>
<li>High-level glue for common Dat and <a href="https://github.com/mafintosh/hyperdrive">hyperdrive</a> modules.</li>
<li>Sane defaults and consistent management of storage &amp; secret keys across applications, using <a href="https://github.com/datproject/dat-storage">dat-storage</a>.</li>
<li>Easily connect to the Dat network, using <a href="https://github.com/mafintosh/discovery-swarm">discovery-swarm</a></li>
<li>Import files from the file system, using <a href="https://github.com/mafintosh/mirror-folder/">mirror-folder</a></li>
<li>Serve dats over http with <a href="https://github.com/joehand/hyperdrive-http">hyperdrive-http</a></li>
<li>Access APIs to lower level modules with a single <code>require</code>!</li>
</ul>
<h4 id="browser-support"><a href="#browser-support" class="anchor"></a>Browser Support</h4><p>Many of our dependencies work in the browser, but <code>dat-node</code> is tailored for file system applications. See <a href="https://github.com/datproject/dat-js">dat-js</a> if you want to build browser-friendly Dat applications.</p>
<h2 id="example"><a href="#example" class="anchor"></a>Example</h2><p>To send files via Dat:</p>
<ol>
<li>Tell dat-node where the files are.</li>
<li>Import the files.</li>
<li>Share the files on the Dat network! (And share the link)</li>
</ol>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> Dat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'dat-node'</span>)

<span class="hljs-comment">// 1. My files are in /joe/cat-pic-analysis</span>
Dat(<span class="hljs-string">'/joe/cat-pic-analysis'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err

  <span class="hljs-comment">// 2. Import the files</span>
  dat.importFiles()

  <span class="hljs-comment">// 3. Share the files on the network!</span>
  dat.joinNetwork()
  <span class="hljs-comment">// (And share the link)</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'My Dat link is: dat://'</span>, dat.key.toString(<span class="hljs-string">'hex'</span>))
})
</code></pre>
<p>These files are now available to share over the dat network via the key printed in the console.</p>
<p>To download the files, you can make another dat-node instance in a different folder. This time we also have three steps:</p>
<ol>
<li>Tell dat where I want to download the files.</li>
<li>Tell dat what the link is.</li>
<li>Join the network and download!</li>
</ol>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> Dat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'dat-node'</span>)

<span class="hljs-comment">// 1. Tell Dat where to download the files</span>
Dat(<span class="hljs-string">'/download/cat-analysis'</span>, {
  <span class="hljs-comment">// 2. Tell Dat what link I want</span>
  key: <span class="hljs-string">'&lt;dat-key&gt;'</span> <span class="hljs-comment">// (a 64 character hash from above)</span>
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err

  <span class="hljs-comment">// 3. Join the network &amp; download (files are automatically downloaded)</span>
  dat.joinNetwork()
})
</code></pre>
<p>Thats it! By default, all files are automatically downloaded when you connect to the other users.</p>
<p>Dig into more use cases below and please let us know if you have questions! You can <a href="https://github.com/datproject/dat-node/issues">open a new issue</a> or talk to nice humans in <a href="https://gitter.im/datproject/discussions">our chat room</a>.</p>
<h3 id="example-applications"><a href="#example-applications" class="anchor"></a>Example Applications</h3><ul>
<li><a href="https://github.com/datproject/dat">Dat CLI</a>: We use dat-node in the dat CLI.</li>
<li><a href="https://github.com/datproject/dat-desktop">Dat Desktop</a>: The Dat Desktop application manages multiple dat-node instances via <a href="https://github.com/juliangruber/dat-worker">dat-worker</a>.</li>
<li>See the <a href="examples">examples folder</a> for a minimal share + download usage.</li>
<li>And more! Let us know if you have a neat dat-node application to add here.</li>
</ul>
<h2 id="usage"><a href="#usage" class="anchor"></a>Usage</h2><p>All dat-node applications have a similar structure around three main elements:</p>
<ol>
<li><strong>Storage</strong> - where the files and metadata are stored.</li>
<li><strong>Network</strong> - connecting to other users to upload or download data.</li>
<li><strong>Adding Files</strong> - adding files from the file system to the hyperdrive archive.</li>
</ol>
<p>We&#39;ll go through what these are for and a few of the common usages of each element.</p>
<h3 id="storage"><a href="#storage" class="anchor"></a>Storage</h3><p>Every dat archive has <strong>storage</strong>, this is the required first argument for dat-node. By default, we use <a href="http://github.com/datproject/dat-storage">dat-storage</a> which stores the secret key in <code>~/.dat/</code> and the rest of the ddata in <code>dir/.dat</code>. Other common options are:</p>
<ul>
<li><strong>Persistent storage</strong>: Stored files in <code>/my-dir</code> and metadata in <code>my-dir/.dat</code> by passing <code>/my-dir</code> as the first argument.</li>
<li><strong>Temporary Storage</strong>: Use the <code>temp: true</code> option to keep metadata stored in memory.</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// Permanent Storage</span>
Dat(<span class="hljs-string">'/my-dir'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  <span class="hljs-comment">// Do Dat Stuff</span>
})

<span class="hljs-comment">// Temporary Storage</span>
Dat(<span class="hljs-string">'/my-dir'</span>, {<span class="hljs-attr">temp</span>: <span class="hljs-literal">true</span>}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  <span class="hljs-comment">// Do Dat Stuff</span>
})
</code></pre>
<p>Both of these will import files from <code>/my-dir</code> when doing <code>dat.importFiles()</code> but only the first will make a <code>.dat</code> folder and keep the metadata on disk.</p>
<p>The storage argument can also be passed through to hyperdrive for more advanced storage use cases.</p>
<h3 id="network"><a href="#network" class="anchor"></a>Network</h3><p>Dat is all about the network! You&#39;ll almost always want to join the network right after you create your Dat:</p>
<pre><code class="lang-js">Dat(<span class="hljs-string">'/my-dir'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  dat.joinNetwork()
  dat.network.on(<span class="hljs-string">'connection'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'I connected to someone!'</span>)
  })
})
</code></pre>
<h4 id="downloading-files"><a href="#downloading-files" class="anchor"></a>Downloading Files</h4><p>Remember, if you are downloading - metadata and file downloads will happen automatically once you join the network!</p>
<p>Dat runs on a peer to peer network, sometimes there may not be anyone online for a particular key. You can make your application more user friendly by using the callback in <code>joinNetwork</code>:</p>
<pre><code class="lang-js"><span class="hljs-comment">// Downloading &lt;key&gt; with joinNetwork callback</span>
Dat(<span class="hljs-string">'/my-dir'</span>, {<span class="hljs-attr">key</span>: <span class="hljs-string">'&lt;key&gt;'</span>}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  dat.joinNetwork(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err

    <span class="hljs-comment">// After the first round of network checks, the callback is called</span>
    <span class="hljs-comment">// If no one is online, you can exit and let the user know.</span>
    <span class="hljs-keyword">if</span> (!dat.network.connected || !dat.network.connecting) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'No users currently online for that key.'</span>)
      process.exit(<span class="hljs-number">1</span>)
    }
  })
})
</code></pre>
<h5 id="download-on-demand"><a href="#download-on-demand" class="anchor"></a>Download on Demand</h5><p>If you want to control what files and metadata are downloaded, you can use the sparse option:</p>
<pre><code class="lang-js"><span class="hljs-comment">// Downloading &lt;key&gt; with sparse option</span>
Dat(<span class="hljs-string">'/my-dir'</span>, {<span class="hljs-attr">key</span>: <span class="hljs-string">'&lt;key&gt;'</span>, <span class="hljs-attr">sparse</span>: <span class="hljs-literal">true</span>}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  dat.joinNetwork()

  <span class="hljs-comment">// Manually download files via the hyperdrive API:</span>
  dat.archive.readFile(<span class="hljs-string">'/cat-locations.txt'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, content</span>) </span>{
    <span class="hljs-built_in">console</span>.log(content) <span class="hljs-comment">// prints cat-locations.txt file!</span>
  })
})
</code></pre>
<p>Dat will only download metadata and content for the parts you request with <code>sparse</code> mode!</p>
<h3 id="importing-files"><a href="#importing-files" class="anchor"></a>Importing Files</h3><p>There are many ways to get files imported into an archive! Dat node provides a few basic methods. If you need more advanced imports, you can use the <code>archive.createWriteStream()</code> methods directly.</p>
<p>By default, just call <code>dat.importFiles()</code> to import from the directory you initialized with. You can watch that folder for changes by setting the watch option:</p>
<pre><code class="lang-js">Dat(<span class="hljs-string">'/my-data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err

  <span class="hljs-keyword">var</span> progress = dat.importFiles({<span class="hljs-attr">watch</span>: <span class="hljs-literal">true</span>}) <span class="hljs-comment">// with watch: true, there is no callback</span>
  progress.on(<span class="hljs-string">'put'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">src, dest</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Importing '</span>, src.name, <span class="hljs-string">' into archive'</span>)
  })
})
</code></pre>
<p>You can also import from another directory:</p>
<pre><code class="lang-js">Dat(<span class="hljs-string">'/my-data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, dat</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err

  dat.importFiles(<span class="hljs-string">'/another-dir'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'done importing another-dir'</span>)
  })
})
</code></pre>
<p>That covers some of the common use cases, let us know if there are more to add! Keep reading for the full API docs.</p>
<h2 id="api"><a href="#api" class="anchor"></a>API</h2><p><strong>Warning:</strong> This is an early <code>2.0</code> release of dat-node. Please let us know if you missing or incorrect API docs here. We still have more to document. PRs more than welcome!</p>
<h3 id="datdirorstorage-opts-callbackerr-dat"><a href="#datdirorstorage-opts-callbackerr-dat" class="anchor"></a><code>Dat(dir|storage, [opts], callback(err, dat))</code></h3><p>Initialize a Dat Archive in <code>dir</code>. If there is an existing Dat Archive, the archive will be resumed.</p>
<h4 id="storage"><a href="#storage" class="anchor"></a>Storage</h4><ul>
<li><code>dir</code> (Default) - Use <a href="https://github.com/datproject/dat-storage">dat-storage</a> inside <code>dir</code>. This stores files as files, sleep files inside <code>.dat</code>, and the secret key in the user&#39;s home directory.</li>
<li><code>dir</code> with <code>opts.latest: false</code> - Store as SLEEP files, including storing the content as a <code>content.data</code> file. This is useful for storing all history in a single flat file.</li>
<li><code>dir</code> with <code>opts.temp: true</code> - Store everything in memory (including files).</li>
<li><code>storage</code> function - pass a custom storage function along to hyperdrive, see dat-storage for an example.</li>
</ul>
<p>Most options are passed directly to the module you&#39;re using (e.g. <code>dat.importFiles(opts)</code>. However, there are also some initial <code>opts</code> can include:</p>
<pre><code class="lang-js">opts = {
  <span class="hljs-attr">key</span>: <span class="hljs-string">'&lt;dat-key&gt;'</span>, <span class="hljs-comment">// existing key to create archive with or resume</span>
  temp: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Use random-access-memory as the storage.</span>

  <span class="hljs-comment">// Hyperdrive options</span>
  sparse: <span class="hljs-literal">false</span> <span class="hljs-comment">// download only files you request</span>
}
</code></pre>
<p>The callback, <code>cb(err, dat)</code>, includes a <code>dat</code> object that has the following properties:</p>
<ul>
<li><code>dat.key</code>: key of the dat (this will be set later for non-live archives)</li>
<li><code>dat.archive</code>: Hyperdrive archive instance.</li>
<li><code>dat.path</code>: Path of the Dat Archive</li>
<li><code>dat.live</code>: <code>archive.live</code></li>
<li><code>dat.writable</code>: Is the <code>archive</code> writable?</li>
<li><code>dat.resumed</code>: <code>true</code> if the archive was resumed from an existing database</li>
<li><code>dat.options</code>: All options passed to Dat and the other submodules</li>
</ul>
<h3 id="module-interfaces"><a href="#module-interfaces" class="anchor"></a>Module Interfaces</h3><p><strong><code>dat-node</code> provides an easy interface to common Dat modules for the created Dat Archive on the <code>dat</code> object provided in the callback:</strong></p>
<h4 id="var-network-datjoinnetworkopts-cb"><a href="#var-network-datjoinnetworkopts-cb" class="anchor"></a><code>var network = dat.joinNetwork([opts], [cb])</code></h4><p>Join the network to start transferring data for <code>dat.key</code>, using <a href="https://github.com/mafintosh/discovery-swarm">discovery-swarm</a>. You can also can use <code>dat.join([opts], [cb])</code>.</p>
<p>If you specify <code>cb</code>, it will be called <em>when the first round</em> of discovery has completed. This is helpful to check immediately if peers are available and if not fail gracefully, more similar to http requests.</p>
<p>Returns a <code>network</code> object with properties:</p>
<ul>
<li><code>network.connected</code> - number of peers connected</li>
<li><code>network.on(&#39;listening&#39;)</code> - emitted with network is listening</li>
<li><code>network.on(&#39;connection&#39;, connection, info)</code> - Emitted when you connect to another peer. Info is an object that contains info about the connection</li>
</ul>
<h5 id="network-options"><a href="#network-options" class="anchor"></a>Network Options</h5><p><code>opts</code> are passed to discovery-swarm, which can include:</p>
<pre><code class="lang-js">opts = {
  <span class="hljs-attr">upload</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// announce and upload data to other peers</span>
  download: <span class="hljs-literal">true</span>, <span class="hljs-comment">// download data from other peers</span>
  port: <span class="hljs-number">3282</span>, <span class="hljs-comment">// port for discovery swarm</span>
  utp: <span class="hljs-literal">true</span>, <span class="hljs-comment">// use utp in discovery swarm</span>
  tcp: <span class="hljs-literal">true</span> <span class="hljs-comment">// use tcp in discovery swarm</span>
}

<span class="hljs-comment">//Defaults from datland-swarm-defaults can also be overwritten:</span>

opts = {
  <span class="hljs-attr">dns</span>: {
    <span class="hljs-attr">server</span>: <span class="hljs-comment">// DNS server</span>
    domain: <span class="hljs-comment">// DNS domain</span>
  }
  dht: {
    <span class="hljs-attr">bootstrap</span>: <span class="hljs-comment">// distributed hash table bootstrapping nodes</span>
  }
}
</code></pre>
<p>Returns a <a href="https://github.com/mafintosh/discovery-swarm">discovery-swarm</a> instance.</p>
<h4 id="datleavenetwork-or-datleave"><a href="#datleavenetwork-or-datleave" class="anchor"></a><code>dat.leaveNetwork()</code> or <code>dat.leave()</code></h4><p>Leaves the network for the archive.</p>
<h4 id="var-importer-datimportfilessrc-opts-cb"><a href="#var-importer-datimportfilessrc-opts-cb" class="anchor"></a><code>var importer = dat.importFiles([src], [opts], [cb])</code></h4><p><strong>Archive must be writable to import.</strong></p>
<p>Import files to your Dat Archive from the directory using <a href="https://github.com/mafintosh/mirror-folder/">mirror-folder</a>.</p>
<ul>
<li><code>src</code> - By default, files will be imported from the folder where the archive was initiated. Import files from another directory by specifying <code>src</code>.</li>
<li><code>opts</code> - options passed to mirror-folder (see below).</li>
<li><code>cb</code> - called when import is finished.</li>
</ul>
<p>Returns a <code>importer</code> object with properties:</p>
<ul>
<li><code>importer.on(&#39;error&#39;, err)</code></li>
<li><code>importer.on(&#39;put&#39;, src, dest)</code> - file put started. <code>src.live</code> is true is file was added by file watch event.</li>
<li><code>importer.on(&#39;put-data&#39;, chunk)</code> - chunk of file added</li>
<li><code>importer.on(&#39;put-end&#39;, src, dest)</code> - end of file write stream</li>
<li><code>importer.on(&#39;del&#39;, dest)</code> - file deleted from dest</li>
<li><code>importer.on(&#39;end&#39;)</code> - Emits when mirror is done (not emitted in watch mode)</li>
<li>If <code>opts.count</code> is true:<ul>
<li><code>importer.on(&#39;count&#39;, {files, bytes})</code> - Emitted after initial scan of src directory. See import progress section for details.</li>
<li><code>importer.count</code> will be <code>{files, bytes}</code> to import after initial scan.</li>
<li><code>importer.putDone</code> will track <code>{files, bytes}</code> for imported files.</li>
</ul>
</li>
</ul>
<h5 id="importer-options"><a href="#importer-options" class="anchor"></a>Importer Options</h5><p>Options include:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> opts = {
  <span class="hljs-attr">count</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// do an initial dry run import for rendering progress</span>
  ignoreHidden: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ignore hidden files  (if false, .dat will still be ignored)</span>
  ignoreDirs: <span class="hljs-literal">true</span>, <span class="hljs-comment">// do not import directories (hyperdrive does not need them and it pollutes metadata)</span>
  useDatIgnore: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ignore entries in the `.datignore` file from import dir target.</span>
  ignore: <span class="hljs-comment">// (see below for default info) anymatch expression to ignore files</span>
  watch: <span class="hljs-literal">false</span>, <span class="hljs-comment">// watch files for changes &amp; import on change (archive must be live)</span>
}
</code></pre>
<h5 id="ignoring-files"><a href="#ignoring-files" class="anchor"></a>Ignoring Files</h5><p>You can use a <code>.datignore</code> file in the imported directory, <code>src</code>, to ignore any the user specifies. This is done by default.</p>
<p><code>dat-node</code> uses <a href="https://github.com/joehand/dat-ignore">dat-ignore</a> to provide a default ignore option, ignoring the <code>.dat</code> folder and all hidden files or directories. Use <code>opts.ignoreHidden = false</code> to import hidden files or folders, except the <code>.dat</code> directory.</p>
<p><em>It&#39;s important that the <code>.dat</code> folder is not imported because it contains a private key that allows the owner to write to the archive.</em></p>
<h4 id="var-stats-dattrackstats"><a href="#var-stats-dattrackstats" class="anchor"></a><code>var stats = dat.trackStats()</code></h4><h5 id="statsonupdate"><a href="#statsonupdate" class="anchor"></a><code>stats.on(&#39;update&#39;)</code></h5><p>Emitted when archive stats are updated. Get new stats with <code>stats.get()</code>.</p>
<h5 id="var-st-statsget"><a href="#var-st-statsget" class="anchor"></a><code>var st = stats.get()</code></h5><p>Get general archive stats for the latest version:</p>
<pre><code class="lang-js">{
  <span class="hljs-attr">files</span>: <span class="hljs-number">12</span>,
  <span class="hljs-attr">byteLength</span>: <span class="hljs-number">1234</span>,
  <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>, <span class="hljs-comment">// number of blocks for latest files</span>
  version: <span class="hljs-number">6</span>, <span class="hljs-comment">// archive.version for these stats</span>
  downloaded: <span class="hljs-number">4</span> <span class="hljs-comment">// number of downloaded blocks for latest</span>
}
</code></pre>
<h5 id="statsnetwork"><a href="#statsnetwork" class="anchor"></a><code>stats.network</code></h5><p>Get upload and download speeds: <code>stats.network.uploadSpeed</code> or <code>stats.network.downloadSpeed</code>. Transfer speeds are tracked using <a href="https://github.com/joehand/hyperdrive-network-speed/">hyperdrive-network-speed</a>.</p>
<h5 id="var-peers-statspeers"><a href="#var-peers-statspeers" class="anchor"></a><code>var peers = stats.peers</code></h5><ul>
<li><code>peers.total</code> - total number of connected peers</li>
<li><code>peers.complete</code> - connected peers with all the content data</li>
</ul>
<h4 id="var-server-datservehttpopts"><a href="#var-server-datservehttpopts" class="anchor"></a><code>var server = dat.serveHttp(opts)</code></h4><p>Serve files over http via <a href="https://github.com/joehand/hyperdrive-http">hyperdrive-http</a>. Returns a node http server instance.</p>
<pre><code class="lang-js">opts = {
  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>, <span class="hljs-comment">// http port</span>
  live: <span class="hljs-literal">true</span>, <span class="hljs-comment">// live update directory index listing</span>
  footer: <span class="hljs-string">'Served via Dat.'</span>, <span class="hljs-comment">// Set a footer for the index listing</span>
  exposeHeaders: <span class="hljs-literal">false</span> <span class="hljs-comment">// expose dat key in headers</span>
}
</code></pre>
<h4 id="datpause"><a href="#datpause" class="anchor"></a><code>dat.pause()</code></h4><p>Pause all upload &amp; downloads. Currently, this is the same as <code>dat.leaveNetwork()</code>, which leaves the network and destroys the swarm. Discovery will happen again on <code>resume()</code>.</p>
<h4 id="datresume"><a href="#datresume" class="anchor"></a><code>dat.resume()</code></h4><p>Resume network activity. Current, this is the same as <code>dat.joinNetwork()</code>.</p>
<h4 id="datclosecb"><a href="#datclosecb" class="anchor"></a><code>dat.close(cb)</code></h4><p>Stops replication and closes all the things opened for dat-node, including:</p>
<ul>
<li><code>dat.archive.close(cb)</code></li>
<li><code>dat.network.close(cb)</code></li>
<li><code>dat.importer.destroy()</code> (file watcher)</li>
</ul>
<h2 id="license"><a href="#license" class="anchor"></a>License</h2><p>MIT</p>
</div>
  </div>
        </div>
      </main>
    </div>
<script src="/bundle.js"></script>
</body>
</html>
