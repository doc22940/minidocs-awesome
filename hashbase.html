<!doctype html>
<html lang="en" dir="ltr">
<head>
<title>Awesome Dat</title>
<meta charset="utf-8">

<link rel="stylesheet" href="/bundle.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/style.css">
</head>
<body>
<div id="choo-root" class="_d4e87350 minidocs flex flex-column m0 h-100">
      <div class="minidocs-header-flex flex">
        <header class="_19f2d18a minidocs-header ph4 w-100 bg-black-90">
    <nav class="flex justify-between">
      <div class="flex items-center">
        <div class="menu-button">
          <a class=" menu-toggle"></a>
        </div>
        <a href="/" title="Awesome Dat" class="inline-flex items-center">
        <img src="/dat-data-logo.svg" alt="Awesome Dat" class="minidocs-header-logo dib w2 h2" />
        <span class="minidocs-header-title ml2 pr2 white">Awesome Dat</span>
      </a>
      </div>
      <div class="minidocs-header-nav flex-grow flex items-center tr ttu">
        <a href="/install" title="Install" class="minidocs-header-link white dim link dn dib-ns mr3-ns">Install</a>
        <a href="http://datproject.org/" title="Home" class="minidocs-header-link white dim link dib mr3-ns">Home</a>
      </div>
    </nav>
  </header>
      </div>
      <main class="minidocs-main-flex flex">
        <div class="minidocs-sidebar-flex open order-0 overflow-auto bg-near-white">
        <div class="_068b628f minidocs-menu pa3">
      <div class="f3 pt2">Welcome</div><div><a href="/awesome-dat" class="content-link ">Awesome Dat</a></div><div class="f3 pt2">Dat Applications</div><div><a href="/dat" class="content-link ">datproject/dat</a></div><div><a href="/dat-desktop" class="content-link ">datproject/dat-desktop</a></div><div class="f3 pt2">Community Applications</div><div><a href="/sciencefair" class="content-link ">codeforscience/sciencefair</a></div><div><a href="/hyperirc" class="content-link ">mafintosh/hyperirc</a></div><div><a href="/soundcloud-archiver" class="content-link ">jondashkyle/soundcloud-archiver</a></div><div><a href="/hypervision" class="content-link ">mafintosh/hypervision</a></div><div><a href="/hypertweet" class="content-link ">joehand/hypertweet</a></div><div><a href="/dat-photos-app" class="content-link ">beakerbrowser/dat-photos-app</a></div><div class="f3 pt2">High-Level APIs</div><div><a href="/dat-node" class="content-link ">datproject/dat-node</a></div><div><a href="/dat-js" class="content-link ">datproject/dat-js</a></div><div><a href="/pauls-dat-api" class="content-link ">beakerbrowser/pauls-dat-api</a></div><div><a href="/node-dat-archive" class="content-link ">beakerbrowser/node-dat-archive</a></div><div class="f3 pt2">Hosting &amp; Dat Management</div><div><a href="/hypercore-archiver" class="content-link ">mafintosh/hypercore-archiver</a></div><div><a href="/hypercloud" class="content-link ">datprotocol/hypercloud</a></div><div>
            <a href="/hashbase" class="content-link active">beakerbrowser/hashbase</a>
            <div class="minidocs-menu-toc">
              <a href="#setup" class="f5 content-link">Setup</a><a href="#configuration" class="f5 content-link">Configuration</a><a href="#tests" class="f5 content-link">Tests</a><a href="#license" class="f5 content-link">License</a>
            </div>
          </div><div><a href="/dat-now" class="content-link ">joehand/dat-now</a></div><div><a href="/hypercore-archiver-bot" class="content-link ">mafintosh/hypercore-archiver-bot</a></div><div><a href="/hypercore-archiver-ws" class="content-link ">joehand/hypercore-archiver-ws</a></div><div><a href="/dat-registry-api" class="content-link ">datproject/dat-registry-api</a></div><div><a href="/dat-registry-client" class="content-link ">datproject/dat-registry-client</a></div><div class="f3 pt2">Managing &amp; Aggregating Dats</div><div><a href="/multidat" class="content-link ">datproject/multidat</a></div><div><a href="/multidrive" class="content-link ">datproject/multidrive</a></div><div><a href="/dat-pki" class="content-link ">jayrbolton/dat-pki</a></div><div><a href="/injestdb" class="content-link ">beakerbrowser/injestdb</a></div><div class="f3 pt2">Http Hosting</div><div><a href="/hyperdrive-http" class="content-link ">joehand/hyperdrive-http</a></div><div><a href="/dathttpd" class="content-link ">beakerbrowser/dathttpd</a></div><div class="f3 pt2">Dat Link Utilties</div><div><a href="/dat-dns" class="content-link ">datprotocol/dat-dns</a></div><div><a href="/dat-link-resolve" class="content-link ">joehand/dat-link-resolve</a></div><div><a href="/parse-dat-url" class="content-link ">pfrazee/parse-dat-url</a></div><div><a href="/dat-encoding" class="content-link ">juliangruber/dat-encoding</a></div><div class="f3 pt2">Dat Utilities</div><div><a href="/dat-log" class="content-link ">joehand/dat-log</a></div><div><a href="/dat-ls" class="content-link ">mafintosh/dat-ls</a></div><div><a href="/hyperhealth" class="content-link ">karissa/hyperhealth</a></div><div><a href="/hyperdrive-network-speed" class="content-link ">joehand/hyperdrive-network-speed</a></div><div class="f3 pt2">File Imports &amp; Exports</div><div><a href="/hyperdrive-import-files" class="content-link ">juliangruber/hyperdrive-import-files</a></div><div><a href="/mirror-folder" class="content-link ">mafintosh/mirror-folder</a></div><div><a href="/hyperdrive-staging-area" class="content-link ">pfrazee/hyperdrive-staging-area</a></div><div><a href="/hyperdrive-to-zip-stream" class="content-link ">pfrazee/hyperdrive-to-zip-stream</a></div><div class="f3 pt2">Hypercore Tools</div><div><a href="/hyperpipe" class="content-link ">mafintosh/hyperpipe</a></div><div class="f3 pt2">Dat Core Modules</div><div><a href="/hyperdrive" class="content-link ">mafintosh/hyperdrive</a></div><div><a href="/hypercore" class="content-link ">mafintosh/hypercore</a></div><div class="f3 pt2">CLI Utilities</div><div><a href="/dat-doctor" class="content-link ">joehand/dat-doctor</a></div><div><a href="/dat-ignore" class="content-link ">joehand/dat-ignore</a></div><div><a href="/dat-json" class="content-link ">joehand/dat-json</a></div><div class="f3 pt2">Networking</div><div><a href="/hyperdiscovery" class="content-link ">karissa/hyperdiscovery</a></div><div><a href="/discovery-swarm" class="content-link ">mafintosh/discovery-swarm</a></div><div><a href="/webrtc-swarm" class="content-link ">mafintosh/webrtc-swarm</a></div><div><a href="/dat-swarm-defaults" class="content-link ">joehand/dat-swarm-defaults</a></div><div class="f3 pt2">Lower level networking modules</div><div><a href="/discovery-channel" class="content-link ">maxogden/discovery-channel</a></div><div><a href="/dns-discovery" class="content-link ">mafintosh/dns-discovery</a></div><div><a href="/multicast-dns" class="content-link ">mafintosh/multicast-dns</a></div><div><a href="/bittorrent-dht" class="content-link ">webtorrent/bittorrent-dht</a></div><div><a href="/utp-native" class="content-link ">mafintosh/utp-native</a></div><div><a href="/signalhub" class="content-link ">mafintosh/signalhub</a></div><div class="f3 pt2">Storage</div><div><a href="/dat-storage" class="content-link ">datproject/dat-storage</a></div><div><a href="/dat-secret-storage" class="content-link ">datproject/dat-secret-storage</a></div><div class="f3 pt2">Random Access</div><div><a href="/abstract-random-access" class="content-link ">juliangruber/abstract-random-access</a></div><div><a href="/multi-random-access" class="content-link ">mafintosh/multi-random-access</a></div><div><a href="/random-access-file" class="content-link ">mafintosh/random-access-file</a></div><div><a href="/random-access-memory" class="content-link ">mafintosh/random-access-memory</a></div><div><a href="/random-access-page-files" class="content-link ">mafintosh/random-access-page-files</a></div><div><a href="/dat-http" class="content-link ">datproject/dat-http</a></div><div><a href="/random-access-idb" class="content-link ">substack/random-access-idb</a></div><div class="f3 pt2">Other Related Dat Project Modules</div><div><a href="/peer-network" class="content-link ">mafintosh/peer-network</a></div><div><a href="/hyperdht" class="content-link ">mafintosh/hyperdht</a></div><div class="f3 pt2">Dat Project Organization Stuff</div><div><a href="/datproject.org" class="content-link ">datproject/datproject.org</a></div><div><a href="/discussions" class="content-link ">datproject/discussions</a></div><div><a href="/design" class="content-link ">datproject/design</a></div><div><a href="/dat-elements" class="content-link ">datproject/dat-elements</a></div><div><a href="/dat-colors" class="content-link ">kriesse/dat-colors</a></div><div><a href="/dat-icons" class="content-link ">kriesse/dat-icons</a></div><div><a href="/dat.json" class="content-link ">juliangruber/dat.json</a></div><div class="f3 pt2">Outdated</div><div><a href="/dat.haus" class="content-link ">juliangruber/dat.haus</a></div><div><a href="/hyperfeed" class="content-link ">poga/hyperfeed</a></div><div><a href="/normcore" class="content-link ">yoshuawuyts/normcore</a></div><div><a href="/github-to-hypercore" class="content-link ">yoshuawuyts/github-to-hypercore</a></div><div><a href="/hyperspark" class="content-link ">poga/hyperspark</a></div><div><a href="/hypercore-index" class="content-link ">juliangruber/hypercore-index</a></div><div><a href="/hyperdrive-encoding" class="content-link ">juliangruber/hyperdrive-encoding</a></div><div><a href="/hyperdrive-http-server" class="content-link ">mafintosh/hyperdrive-http-server</a></div><div><a href="/hyperdrive-http" class="content-link ">joehand/hyperdrive-http</a></div><div><a href="/dat-push" class="content-link ">joehand/dat-push</a></div><div><a href="/dat-backup" class="content-link ">joehand/dat-backup</a></div><div><a href="/archiver-server" class="content-link ">joehand/archiver-server</a></div><div><a href="/archiver-api" class="content-link ">joehand/archiver-api</a></div><div><a href="/hyperdrive-ln" class="content-link ">poga/hyperdrive-ln</a></div><div><a href="/hyperdrive-multiwriter" class="content-link ">substack/hyperdrive-multiwriter</a></div><div><a href="/hyperdrive-named-archives" class="content-link ">substack/hyperdrive-named-archives</a></div><div><a href="/git-dat" class="content-link ">substack/git-dat</a></div><div><a href="/jawn" class="content-link ">CfABrigadePhiladelphia/jawn</a></div><div><a href="/dat-archiver" class="content-link ">maxogden/dat-archiver</a></div><div><a href="/hyperdrive-stats" class="content-link ">juliangruber/hyperdrive-stats</a></div><div><a href="/hypercore-stats-server" class="content-link ">karissa/hypercore-stats-server</a></div><div><a href="/hypercore-stats-ui" class="content-link ">mafintosh/hypercore-stats-ui</a></div><div><a href="/zip-to-hyperdrive" class="content-link ">karissa/zip-to-hyperdrive</a></div><div><a href="/url-dat" class="content-link ">joehand/url-dat</a></div><div><a href="/tar-dat" class="content-link ">joehand/tar-dat</a></div><div><a href="/hyperdrive-duplicate" class="content-link ">joehand/hyperdrive-duplicate</a></div>
    </div>
      </div>
        <div id="minidocs-content" class="minidocs-content-flex order-1 overflow-auto">
          <div class="_32076d68 pa3 ph5-ns pv4-ns">
    
    
    <div><h1 id="hashbase"><a href="#hashbase" class="anchor"></a>Hashbase</h1><p>Hashbase is a public peer service for <a href="https://datproject.org">Dat</a> archives. It provides a HTTP-accessible interface for creating an account and uploading Dats. It was created to power a content-community for the <a href="https://beakerbrowser.com">Beaker Browser</a></p>
<p>Links:</p>
<ul>
<li><strong><a href="https://hashbase.io">Hashbase.io</a></strong></li>
<li><strong><a href="./docs">Documentation</a></strong></li>
</ul>
<h2 id="setup"><a href="#setup" class="anchor"></a>Setup</h2><p>Clone this repository, then run</p>
<pre><code>npm install
cp config<span class="hljs-selector-class">.defaults</span><span class="hljs-selector-class">.yml</span> config<span class="hljs-selector-class">.development</span><span class="hljs-selector-class">.yml</span>
</code></pre><p>Modify <code>config.development.yml</code> to fit your needs, then start the server with <code>npm start</code>.</p>
<h2 id="configuration"><a href="#configuration" class="anchor"></a>Configuration</h2><p>Before deploying the service, you absolutely <em>must</em> modify the following config.</p>
<h4 id="basics"><a href="#basics" class="anchor"></a>Basics</h4><pre><code class="lang-yaml"><span class="hljs-attr">dir:</span> <span class="hljs-string">./.hashbase</span>              <span class="hljs-comment"># where to store the data</span>
<span class="hljs-attr">brandname:</span> <span class="hljs-string">Hashbase</span>           <span class="hljs-comment"># the title of your service</span>
<span class="hljs-attr">hostname:</span> <span class="hljs-string">hashbase.local</span>      <span class="hljs-comment"># the hostname of your service</span>
<span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>                    <span class="hljs-comment"># the port to run the service on</span>
<span class="hljs-attr">rateLimiting:</span> <span class="hljs-literal">true</span>            <span class="hljs-comment"># rate limit the HTTP requests?</span>
<span class="hljs-attr">csrf:</span> <span class="hljs-literal">true</span>                    <span class="hljs-comment"># use csrf tokens?</span>
<span class="hljs-attr">defaultDiskUsageLimit:</span> <span class="hljs-number">100</span><span class="hljs-string">mb</span>  <span class="hljs-comment"># default maximum disk usage for each user</span>
</code></pre>
<h4 id="lets-encrypt"><a href="#lets-encrypt" class="anchor"></a>Lets Encrypt</h4><p>You can enable lets-encrypt to automatically provision TLS certs using this config:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">letsencrypt:</span>
<span class="hljs-attr">  debug:</span> <span class="hljs-literal">false</span>          <span class="hljs-comment"># debug mode? must be set to 'false' to use live config</span>
<span class="hljs-attr">  email:</span> <span class="hljs-string">'foo@bar.com'</span>  <span class="hljs-comment"># email to register domains under</span>
</code></pre>
<p>If enabled, <code>port</code> will be ignored and the server will register at ports 80 and 443.</p>
<h4 id="admin-account"><a href="#admin-account" class="anchor"></a>Admin Account</h4><p>The admin user has its credentials set by the config yaml at load. If you change the password while the server is running, then restart the server, the password will be reset to whatever is in the config.</p>
<pre><code class="lang-yaml"><span class="hljs-attr">admin:</span>
<span class="hljs-attr">  email:</span> <span class="hljs-string">'foo@bar.com'</span>
<span class="hljs-attr">  password:</span> <span class="hljs-string">myverysecretpassword</span>
</code></pre>
<h4 id="http-sites"><a href="#http-sites" class="anchor"></a>HTTP Sites</h4><p>Hashbase can host the archives as HTTP sites. This has the added benefit of enabling <a href="https://npm.im/dat-dns">dat-dns shortnames</a> for the archives. There are two possible schemes:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">sites:</span> <span class="hljs-string">per-user</span>
</code></pre>
<p>Per-user will host archives at <code>username.hostname/archivename</code>, in a scheme similar to GitHub Pages. If the archive-name is == to the username, it will be hosted at <code>username.hostname</code>.</p>
<p>Note that, in this scheme, a DNS shortname is only provided for the user archive (<code>username.hostname</code>).</p>
<pre><code class="lang-yaml"><span class="hljs-attr">sites:</span> <span class="hljs-string">per-archive</span>
</code></pre>
<p>Per-archive will host archives at <code>archivename-username.hostname</code>. If the archive-name is == to the username, it will be hosted at <code>username.hostname</code>.</p>
<p>By default, HTTP Sites are disabled.</p>
<h4 id="closed-registration"><a href="#closed-registration" class="anchor"></a>Closed Registration</h4><p>For a private instance, use closed registration with a whitelist of allowed emails:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">registration:</span>
<span class="hljs-attr">  open:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">  allowed:</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">alice@mail.com</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">bob@mail.com</span>
</code></pre>
<h4 id="reserved-usernames"><a href="#reserved-usernames" class="anchor"></a>Reserved Usernames</h4><p>Use reserved usernames to blacklist usernames which collide with frontend routes, or which might be used maliciously.</p>
<pre><code class="lang-yaml"><span class="hljs-attr">registration:</span>
<span class="hljs-attr">  reservedNames:</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">admin</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">root</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">support</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">noreply</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">users</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">archives</span>
</code></pre>
<h4 id="monitoring"><a href="#monitoring" class="anchor"></a>Monitoring</h4><pre><code class="lang-yaml"><span class="hljs-attr">pm2:</span> <span class="hljs-literal">false</span>         <span class="hljs-comment"># set to true if you're using https://keymetrics.io/</span>
<span class="hljs-attr">alerts:</span>
<span class="hljs-attr">  diskUsage:</span> <span class="hljs-number">10</span><span class="hljs-string">gb</span>  <span class="hljs-comment"># when to trigger an alert on disk usage</span>
</code></pre>
<h4 id="session-tokens"><a href="#session-tokens" class="anchor"></a>Session Tokens</h4><p>Hashbase uses Json Web Tokens to manage sessions. You absolutely <em>must</em> replace the <code>secret</code> with a random string before deployment.</p>
<pre><code class="lang-yaml"><span class="hljs-attr">sessions:</span>
<span class="hljs-attr">  algorithm:</span> <span class="hljs-string">HS256</span>                <span class="hljs-comment"># probably dont update this</span>
<span class="hljs-attr">  secret:</span> <span class="hljs-string">THIS</span> <span class="hljs-string">MUST</span> <span class="hljs-string">BE</span> <span class="hljs-string">REPLACED!</span>  <span class="hljs-comment"># put something random here</span>
<span class="hljs-attr">  expiresIn:</span> <span class="hljs-number">1</span><span class="hljs-string">h</span>                   <span class="hljs-comment"># how long do sessions live?</span>
</code></pre>
<h4 id="jobs"><a href="#jobs" class="anchor"></a>Jobs</h4><p>Hashbase runs some jobs periodically. You can configure how frequently they run.</p>
<pre><code class="lang-yaml"><span class="hljs-comment"># processing jobs</span>
<span class="hljs-attr">jobs:</span>
<span class="hljs-attr">  popularArchivesIndex:</span> <span class="hljs-number">30</span><span class="hljs-string">s</span>  <span class="hljs-comment"># compute the index of archives sorted by num peers</span>
<span class="hljs-attr">  userDiskUsage:</span> <span class="hljs-number">5</span><span class="hljs-string">m</span>          <span class="hljs-comment"># compute how much disk space each user is using</span>
<span class="hljs-attr">  deleteDeadArchives:</span> <span class="hljs-number">5</span><span class="hljs-string">m</span>     <span class="hljs-comment"># delete removed archives from disk</span>
</code></pre>
<h4 id="emailer"><a href="#emailer" class="anchor"></a>Emailer</h4><p><em>Todo, sorry</em></p>
<h2 id="tests"><a href="#tests" class="anchor"></a>Tests</h2><p>Run the tests with</p>
<pre><code>npm <span class="hljs-built_in">test</span>
</code></pre><p>To run the tests against a running server, specify the env var:</p>
<pre><code><span class="hljs-comment">REMOTE_URL=http://{hostname}/ npm test</span>
</code></pre><h2 id="license"><a href="#license" class="anchor"></a>License</h2><p>MIT</p>
</div>
  </div>
        </div>
      </main>
    </div>
<script src="/bundle.js"></script>
</body>
</html>
